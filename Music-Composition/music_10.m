clear
F_major = 349.23;
so = F_major * 2 ^ (7/12);
ra = F_major * 2 ^ (9/12);
re = F_major * 2 ^ (2/12);
do = F_major;
down_ra = F_major * 2 ^ (-3/12);
Fs = 8000;
x = 0 : 1/Fs : 4.05; % 4小节，每小节8拍，每拍0.5s

K = 1;
coeff = zeros(10, 1);
coeff(1, 1) = 0.0544886 * K;
coeff(2, 1) = 0.793981 * K;
coeff(3, 1) = 0.0522403 * K;
coeff(4, 1) = 0.0599319 * K;
coeff(5, 1) = 0.00285117 * K;
coeff(6, 1) = 0.00598583 * K;
coeff(7, 1) = 0.0195566 * K;
coeff(8, 1) = 0.00675494 * K;
coeff(9, 1) = 0.00736212 * K;
coeff(10, 1) = 0.00350395 * K;

z = zeros(8, length(x));

for i = 1 : 10
    z(1, :) = z(1, :) + coeff(i, 1) * sin(2*i*pi*so*x);
    z(2, :) = z(2, :) + coeff(i, 1) * sin(2*i*pi*so*(x-0.5));
    z(3, :) = z(3, :) + coeff(i, 1) * sin(2*i*pi*ra*(x-0.75));
    z(4, :) = z(4, :) + coeff(i, 1) * sin(2*i*pi*re*(x-1));
    z(5, :) = z(5, :) + coeff(i, 1) * sin(2*i*pi*do*(x-2));
    z(6, :) = z(6, :) + coeff(i, 1) * sin(2*i*pi*do*(x-2.5));
    z(7, :) = z(7, :) + coeff(i, 1) * sin(2*i*pi*down_ra*(x-2.75));
    z(8, :) = z(8, :) + coeff(i, 1) * sin(2*i*pi*re*(x-3));
end

y1 = z(1, :) .* ((exp(9.1629*x)-1).*(x>=0&x<0.1) + 1.5*exp(-4.05465*(x-0.1)).*(x>=0.1&x<0.2) + 1.*(x>=0.2&x<0.4) + (1.5*exp(-7.3241*(x-0.4))-0.5).*(x>=0.4&x<0.55));
y2 = z(2, :) .* ((exp(18.3258*(x-0.5))-1).*(x>=0.5&x<0.55) + 1.5*exp(-8.1093*(x-0.55)).*(x>=0.55&x<0.6) + 1.*(x>=0.6&x<0.7) + (1.5*exp(-14.6482*(x-0.7))-0.5).*(x>=0.7&x<0.775));
y3 = z(3, :) .* ((exp(18.3258*(x-0.75))-1).*(x>=0.75&x<0.8) + 1.5*exp(-8.1093*(x-0.8)).*(x>=0.8&x<0.85) + 1.*(x>=0.85&x<0.95) + (1.5*exp(-14.6482*(x-0.95))-0.5).*(x>=0.95&x<1.025)); 
y4 = z(4, :) .* ((exp(9.1629*(x-1))-1).*(x>=1&x<1.1) + 1.5*exp(-4.05465*(x-1.1)).*(x>=1.1&x<1.2) + 1.*(x>=1.2&x<1.9) + (1.5*exp(-7.3241*(x-1.9))-0.5).*(x>=1.9&x<2.05)); 
y5 = z(5, :) .* ((exp(9.1629*(x-2))-1).*(x>=2&x<2.1) + 1.5*exp(-4.05465*(x-2.1)).*(x>=2.1&x<2.2) + 1.*(x>=2.2&x<2.4) + (1.5*exp(-7.3241*(x-2.4))-0.5).*(x>=2.4&x<2.55));
y6 = z(6, :) .* ((exp(18.3258*(x-2.5))-1).*(x>=2.5&x<2.55) + 1.5*exp(-8.1093*(x-2.55)).*(x>=2.55&x<2.6) + 1.*(x>=2.6&x<2.7) + (1.5*exp(-14.6482*(x-2.7))-0.5).*(x>=2.7&x<2.775));
y7 = z(7, :) .* ((exp(18.3258*(x-2.75))-1).*(x>=2.75&x<2.8) + 1.5*exp(-8.1093*(x-2.8)).*(x>=2.8&x<2.85) + 1.*(x>=2.85&x<2.95) + (1.5*exp(-14.6482*(x-2.95))-0.5).*(x>=2.95&x<3.025));
y8 = z(8, :) .* ((exp(9.1629*(x-3))-1).*(x>=3&x<3.1) + 1.5*exp(-4.05465*(x-3.1)).*(x>=3.1&x<3.2) + 1.*(x>=3.2&x<3.9) + (1.5*exp(-7.3241*(x-3.9))-0.5).*(x>=3.9&x<4.05)); 

y = y1 + y2 + y3 + y4 + y5 + y6 + y7 + y8;
sound(y, Fs);